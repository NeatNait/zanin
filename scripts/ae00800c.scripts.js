"use strict";angular.module("zaninApp",["ngCookies","ngResource","ngSanitize","ngRoute","ngTouch","ngAnimate","hmTouchEvents"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/splash.html",controller:"SplashCtrl"}).when("/game",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/menu",{templateUrl:"views/menu.html",controller:"MenuCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("zaninApp").controller("MainCtrl",["$rootScope","$scope","$interval","$timeout","$animate","$location",function(a,b,c,d,e,f){function g(){c.cancel(h);var a=c(function(){b.createNewAction()},m);return h=a,a}var h,i,j,k,l=function(a,b){this.gesture=a,this.color=b},m=5e3;b.path="game",b.init=function(){b.colors=[{color:"blue",side:"left"},{color:"red",side:"left"},{color:"green",side:"right"},{color:"yellow",side:"right"}],b.firstClick=null,b.gestures=[{g:"tap"},{g:"doubleTap"}],b.actions=[],b.points=0,b.timeLeft=5,b.totalTimePlayed=0,b.level=1,b.combo=0,b.highestCombo=0,b.maxlvl=20,b.baselvl=2,b.ratePoints=1.2,b.ratetime=1,b.points=b.baselvl,b.maxenergy=7,b.energy=0,b.timeincrease=1,b.actions.push(b.createRandomAction()),b.actions.push(b.createRandomAction()),b.actions.push(b.createRandomAction()),b.actions.push(b.createRandomAction())},b.getComboClass=function(){return Math.ceil(b.combo/20)},b.load=function(){b.init()},i=c(function(){function d(a,b){return Math.log(b)/Math.log(a)}var e=Math.floor(d(b.baselvl,b.points));e<=b.maxlvl&&(b.level=e),b.timeLeft<=0?(b.lvl="GAME OVER",b.level="GAME OVER",b.timeLeft=0,c.cancel(i),a.game={},a.game.points=b.points,a.game.highestCombo=b.highestCombo,f.path("/menu")):b.timeLeft-=Math.floor(b.level/b.ratetime)},1e3),d(function(){b.colors=[{color:"blue",side:"right"},{color:"red",side:"right"},{color:"green",side:"left"},{color:"yellow",side:"left"}]},4e4),c(function(){b.gestures=[{g:"tap"},{g:"doubleTap"},{g:"swipeLeft"},{g:"swipeRight"}]},2e4),b.createRandomAction=function(){var a=b.colors[Math.floor(b.colors.length*Math.random())].color,c=b.gestures[Math.floor(b.gestures.length*Math.random())].g;return new l(c,a)},b.aciertos=function(){b.points+=Math.floor(b.ratePoints*b.level),b.timeLeft+=(b.energy+1)*b.timeincrease,b.combo++,b.energy<b.maxenergy&&b.energy++,b.createNewAction()},b.fallos=function(){b.highestCombo<b.combo&&(b.highestCombo=b.combo),b.combo=0,b.energy=0},b.createNewAction=function(){b.actions.splice(0,1),b.actions.push(b.createRandomAction())};var n,o=function(a){a===b.actions[0].color?(b.aciertos(),g(),e.addClass(angular.element("."+a),"pushed",function(){e.removeClass(angular.element("."+a),"pushed")})):b.fallos()};b.checkGesture=function(a,c,d){return"doubleTap"===j&&"tap"===d&&k===c?(j=d,void(k=c)):(b.actions[0].gesture===d?o(c):"tap"===j&&"tap"===d&&"doubleTap"===b.actions[0].gesture||b.fallos(),j=d,k=c,void(n=a))}}]),angular.module("zaninApp").controller("SplashCtrl",["$scope","$interval","$timeout","$animate","$location",function(a,b,c,d,e){a.path="splash",a.go=function(a){e.path("/"+a)}}]),angular.module("zaninApp").controller("MenuCtrl",["$scope","$interval","$timeout","$animate","$location",function(a,b,c,d,e){a.path="menu",a.go=function(a){e.path(a)}}]);